<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CloudNotes — Analytics</title>
  <link rel="stylesheet" href="style.css">

  <!-- Load app.js FIRST -->
  <script src="app.js"></script>
</head>

<body class="app-root">

  <nav class="sidebar">
    <div class="sidebar-top">
      <div class="brand-small">CloudNotes</div>
      <div id="userBadge" class="user-badge"></div>
    </div>

    <ul class="nav">
      <li><a href="dashboard.html">Dashboard</a></li>
      <li><a href="notes.html">Notes</a></li>
      <li><a href="analytics.html" class="active">Analytics</a></li>

      <!-- ✅ Added Search link here -->
      <li><a href="search.html">Search</a></li>

      <li><a href="#" id="exportPdfBtn">Export PDF</a></li>
      <li><a href="#" id="signoutBtn">Sign out</a></li>
    </ul>
  </nav>


  <main class="main">
    <header class="topbar">
      <h2>Analytics</h2>
    </header>

    <section class="content">

      <div class="grid-2">

        <div class="card">
          <h3>Notes by day (last 7)</h3>
          <canvas id="chartNotes" width="600" height="240"></canvas>
        </div>

        <div class="card">
          <h3>Top keywords</h3>
          <div id="keywordList" class="muted">—</div>
        </div>

      </div>

      <div class="card wide">
        <h3>Raw analytics</h3>
        <pre id="analyticsJson" style="white-space:pre-wrap; font-size:12px;"></pre>
      </div>

    </section>
  </main>


  <script>
    window.onload = async () => {
      // Must be authenticated
      if (!await App.ensureAuth()) return;

      // Load analytics
      await App.loadAnalyticsPage();

      // Bind buttons
      document.getElementById("exportPdfBtn").onclick = () => App.exportPdf();
      document.getElementById("signoutBtn").onclick = () => App.signout();
    };
  </script>

</body>
</html>
